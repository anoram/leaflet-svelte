<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <meta content="Svelte wrapper for leafletjs" name=Description> <base href=/ > <link href=./global.css rel=stylesheet> <link href=./manifest.json rel=manifest crossorigin=use-credentials> <link href=./favicon.png rel=icon type=image/png> <link href=./prism.css rel=stylesheet> <link href=https://unpkg.com/chota@latest rel=stylesheet> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,{}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/client.cad504f2.js"}catch(e){main="/client/legacy/client.f81d29d5.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> <link href=client/assets/client-37b56038.css rel=stylesheet><link href=client/assets/dynamicmarker-5f19e055.css rel=stylesheet><link href=client/assets/Leaflet-24eada1d.css rel=stylesheet> <title>Dynamic marker via bind:this</title> <link href=/client/assets/client-37b56038.css rel=preload as=style><link href=/client/assets/dynamicmarker-5f19e055.css rel=preload as=style><link href=/client/assets/Leaflet-24eada1d.css rel=preload as=style></head> <body> <div id=sapper> <nav class=svelte-1dbd5up><ul class=svelte-1dbd5up><li class=svelte-1dbd5up><a href=. class=svelte-1dbd5up>home</a></li> <li class=svelte-1dbd5up><a href=markers class=svelte-1dbd5up>markers</a></li> <li class=svelte-1dbd5up><a href=misc class=svelte-1dbd5up>misc</a></li> <li class=svelte-1dbd5up><a href=examples class=svelte-1dbd5up aria-current=page>examples</a></ul></nav> <main class=svelte-1fhquo8> <div class=container><div class="is-center row"><div class=col-6><a href=examples>‚ÜêExamples</a> <h4>Dynamic marker via bind:this <span class=chip>@0.0.7^</span></h4> <p>This is still in the testing phase but it is a good release candidate. This example makes use of bind directive. </p> <pre class=language-html><code class=language-html><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> Map <span class="token keyword">from</span> <span class="token string">"@anoram/leaflet-svelte"</span><span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getISS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string">http://api.open-notify.org/iss-now.json</span><span class="token string template-punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> data<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> lat <span class="token operator">=</span> res<span class="token punctuation">.</span>iss_position<span class="token punctuation">.</span>latitude<span class="token punctuation">;</span>
        <span class="token keyword">let</span> lng <span class="token operator">=</span> res<span class="token punctuation">.</span>iss_position<span class="token punctuation">.</span>longitude<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            lat<span class="token punctuation">,</span>
            lng<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
        zoom<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        mapID<span class="token operator">:</span> <span class="token string">"map"</span><span class="token punctuation">,</span>
        markers<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                lat<span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
                lng<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
                popup<span class="token operator">:</span> <span class="token punctuation">{</span>
                    isOpen<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                    text<span class="token operator">:</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string">Static Marker</span><span class="token string template-punctuation">`</span></span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token constant">MAP_EL</span><span class="token punctuation">;</span>

    <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> latlng <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getISS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> marker <span class="token operator">=</span> <span class="token punctuation">{</span>
                lat<span class="token operator">:</span> latlng<span class="token punctuation">.</span>lat<span class="token punctuation">,</span>
                lng<span class="token operator">:</span> latlng<span class="token punctuation">.</span>lng<span class="token punctuation">,</span>
                tooltip<span class="token operator">:</span> <span class="token punctuation">{</span>
                    isOpen<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                    text<span class="token operator">:</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string">International Svelte Station</span><span class="token string template-punctuation">`</span></span><span class="token punctuation">,</span>
                    direction<span class="token operator">:</span> <span class="token string">"top"</span><span class="token punctuation">,</span>
                    sticky<span class="token operator">:</span> <span class="token string">"true"</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                icon<span class="token operator">:</span> <span class="token punctuation">{</span>
                    iconUrl<span class="token operator">:</span> <span class="token string">"./svelte-logo.png"</span><span class="token punctuation">,</span>
                    iconSize<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token constant">MAP_EL</span><span class="token punctuation">.</span><span class="token function">updateMarkers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                markers<span class="token operator">:</span> <span class="token punctuation">[</span>marker<span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
  <span class="token selector">.map</span> <span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 600px<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>map<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Map</span> <span class="token attr-name">{options}</span> <span class="token attr-name"><span class="token namespace">bind:</span>this</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>{MAP_EL}</span> <span class="token attr-name"><span class="token namespace">on:</span>ready</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>{init}</span> <span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre> <h4>Note</h4> <p>This example uses <a href=http://api.open-notify.org/iss-now.json>ISS API</a> to fetch the location and update it once in 5 seconds you will see it. </div> <div class=col-6><div class="map svelte-yphpdh"> <div class="map svelte-1xdqv5q" id=map this=map></div> </div></div></div></div></main></div> <script src=./prism.js></script> 